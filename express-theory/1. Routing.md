

---

# ðŸ“– Express v5+ Routing (Deep Guide)

---

## 1. **Basic Routing with HTTP Methods**

In Express, routing simply means: _matching an incoming request (method + URL) â†’ run a handler (callback)._

Supported methods (shortcuts):

- `app.get(path, handler)`
    
- `app.post(path, handler)`
    
- `app.put(path, handler)`
    
- `app.delete(path, handler)`
    
- `app.patch(path, handler)` (partial update)
    
- `app.all(path, handler)` (catch all methods for a path)
    

ðŸ‘‰ Example:

```js
import express from "express";

const app = express();
app.use(express.json()); // for JSON body parsing

// GET request â†’ read data
app.get("/users", (req, res) => {
  res.send("Get all users");
});

// POST request â†’ create data
app.post("/users", (req, res) => {
  res.send(`Create new user: ${JSON.stringify(req.body)}`);
});

// PUT request â†’ replace data
app.put("/users/:id", (req, res) => {
  res.send(`Replace user with id ${req.params.id}`);
});

// PATCH request â†’ partial update
app.patch("/users/:id", (req, res) => {
  res.send(`Update some fields of user ${req.params.id}`);
});

// DELETE request â†’ remove data
app.delete("/users/:id", (req, res) => {
  res.send(`Delete user with id ${req.params.id}`);
});

// Handle all methods
app.all("/secret", (req, res) => {
  res.send("Accessed secret route with ANY method");
});

app.listen(5000, () => console.log("ðŸš€ Server running on http://localhost:5000"));
```

---

## 2. **Route Parameters**

- Defined with a `:` prefix â†’ `/users/:id`
    
- Captured in `req.params` object.
    
- Always **strings** by default (cast manually if you need numbers).
    

```js
app.get("/users/:id", (req, res) => {
  const { id } = req.params;
  res.send(`User ID: ${id}`);
});
```

ðŸ”¹ Multiple params:

```js
app.get("/users/:userId/books/:bookId", (req, res) => {
  res.send(req.params); 
  // { userId: '42', bookId: '100' }
});
```

âš¡ **New in Express v5**: optional params (`?`), regex params, and modifiers.

```js
// optional param
app.get("/products/:id?", (req, res) => {
  res.send(req.params.id ? `Product ${req.params.id}` : "All products");
});

// regex param (only numbers)
app.get("/order/:orderId(\\d+)", (req, res) => {
  res.send(`Order ID: ${req.params.orderId}`);
});

// splat param (catch-all)
app.get("/files/*path", (req, res) => {
  res.send(`Requested file path: ${req.params.path}`);
});
```

---

## 3. **Query Strings**

- Query params are everything after `?` in the URL.
    
- Available in `req.query`.
    

```js
// http://localhost:5000/search?q=node&sort=asc
app.get("/search", (req, res) => {
  const { q, sort } = req.query;
  res.send(`Search for "${q}", sorted: ${sort}`);
});
```

âš¡ Express does **not** parse nested queries by default (`?filters[name]=john`). If you need that, use `qs` or a middleware like `express-query-parser`.

---

## 4. **Nested & Modular Routes with Router**

When apps grow, we donâ€™t want all routes in `app.js`. Instead, use `express.Router()`.

ðŸ‘‰ Example: user routes in `routes/users.js`

```js
import { Router } from "express";

const router = Router();

// base path: /users
router.get("/", (req, res) => res.send("All users"));
router.post("/", (req, res) => res.send("Create user"));
router.get("/:id", (req, res) => res.send(`User ${req.params.id}`));

export default router;
```

ðŸ‘‰ In `app.js`:

```js
import express from "express";
import userRoutes from "./routes/users.js";

const app = express();

app.use("/users", userRoutes);

app.listen(5000, () => console.log("Server running ðŸš€"));
```

ðŸ”¹ Now:

- `GET /users` â†’ "All users"
    
- `POST /users` â†’ "Create user"
    
- `GET /users/42` â†’ "User 42"
    

---

## 5. **Advanced Routing in Express v5**

Express 5 adds flexibility to route definitions:

- Multiple handlers (middleware chain):
    

```js
function logRequest(req, res, next) {
  console.log(`${req.method} ${req.url}`);
  next(); // pass to next handler
}

app.get("/profile", logRequest, (req, res) => {
  res.send("Profile page");
});
```

- Array of handlers:
    

```js
app.get(
  "/steps",
  [(req, res, next) => { console.log("Step 1"); next(); }],
  (req, res) => res.send("Done")
);
```

- Async/await works natively (Express v5 auto-handles promise rejections):
    

```js
app.get("/async", async (req, res) => {
  const data = await fetch("https://jsonplaceholder.typicode.com/todos/1")
    .then(r => r.json());
  res.json(data);
});
```

---

âœ… **Summary of what youâ€™ve learned in Routing chapter**:

1. Basic HTTP method routes
    
2. Route params (with regex & splats in v5)
    
3. Query strings
    
4. Nested/modular routing with `Router`
    
5. Middleware chaining + async handling
    

---

