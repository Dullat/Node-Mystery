
Since we already touched the basics while explaining Observer Pattern, here we’ll go **deeper into EventEmitter in Node.js** — its API, internals, and some practical tricks.

---

## **1. What is EventEmitter?**

- Built into Node (`events` module).
    
- Implements the Observer pattern.
    
- Every time you use `.on()` and `.emit()` in Node, you’re using it.
    
- Many core Node modules **inherit** from EventEmitter (e.g., `net.Server`, `fs.ReadStream`, `http.Server`).
    

---

## **2. Common Methods**

```js
emitter.on(eventName, listener)         // Add a listener
emitter.once(eventName, listener)       // Add a listener for the first emit only
emitter.emit(eventName, ...args)        // Trigger event
emitter.off(eventName, listener)        // Remove listener
emitter.removeAllListeners(eventName)   // Remove all listeners for an event
emitter.listeners(eventName)            // Get array of listeners for an event
emitter.listenerCount(eventName)        // Get number of listeners
emitter.setMaxListeners(n)              // Avoid memory leak warnings
```

---

## **3. Example — Basic Usage**

```js
const EventEmitter = require('events');
const emitter = new EventEmitter();

function onUserLogin(username) {
    console.log(`${username} has logged in!`);
}

emitter.on('login', onUserLogin);
emitter.emit('login', 'Dullat'); // Triggers listener

// Remove listener
emitter.off('login', onUserLogin);
```

---

## **4. Example — `.once()`**

```js
emitter.once('shutdown', () => {
    console.log('System is shutting down...');
});

emitter.emit('shutdown'); // Runs
emitter.emit('shutdown'); // Won't run again
```

---

## **5. Real-World Example — Chat Room**

```js
const EventEmitter = require('events');
const chatRoom = new EventEmitter();

chatRoom.on('message', (user, msg) => {
    console.log(`[${user}]: ${msg}`);
});

chatRoom.emit('message', 'Alice', 'Hello, World!');
chatRoom.emit('message', 'Bob', 'Hey Alice!');
```

---

## **6. Under the Hood**

Internally, EventEmitter:

- Keeps a **map of events → array of listener functions**.
    
- `.emit()` just loops over the array and calls each listener.
    
- That’s why too many listeners can cause performance warnings (`MaxListenersExceededWarning`).
    

---
